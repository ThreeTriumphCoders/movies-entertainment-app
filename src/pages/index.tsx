import { type NextPage } from "next";
import Head from "next/head";
import { useRef } from "react";
import { MoviesList } from "~/components/MoviesList";

import { Navbar } from "~/components/Navbar";
import { Searchbar } from "~/components/Searchbar";
import { type MovieType } from "~/types/Movie";
import { useGetPopularMovies } from "~/utils/use-queries";

const Home: NextPage = () => {
  const [movies, getMovies] = useGetPopularMovies();
  const page = useRef(1);

  const loadMoreMovies = async () => {
    page.current += 1;

    await getMovies(page.current);
  };

  return (
    <>
      <Head>
        <title>Movies Entertainment</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="min-h-screen bg-dark pb-8 font-body text-light lg:pl-40">
        <Navbar />
        <Searchbar />
        <MoviesList movies={movies} />

        <div className="flex justify-center">
          <button
            onClick={() => void loadMoreMovies()}
            className="rounded-lg bg-primary px-8 py-2 text-dark"
          >
            Load more
          </button>
        </div>
      </main>
    </>
  );
};

export default Home;
